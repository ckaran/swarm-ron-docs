## Base64x64 integer

The Swarm protocol uses lots of ids, timestamps and pre-defined constants.
The unifying format for all of those is a 64 bit integer.
Shorter ints don't have the numbering capacity, while free-form strings are way too expensive (especially Unicode).
Hence, `int64_t` (`long` in Java).
Unfortunately, JavaScript does not have 64-bit integers and JavaScript numbers are [dangerous to use][snowflake] in this context.
Hence, Swarm employs a string-based serialization of 64-bit ints defined by the following requirements:

1. the serialized format should be human-readable to some degree (as it should be used in URLs and paths with no additional recoding),
2. the natural alphanumeric ordering of strings must be the same as the original numeric order of integers (as Swarm does lots of causality-and-order comparisons for ids and timestamps),
3. there should be a variable-length encoding (since 64 bits of numbering capacity is often more than needed, see Google's [varints][varint])

These three requirements are met by our special Base64x64 encoding:

1. Base64x64 serializes 64-bit numbers as 1..10 Base64 chars (10x6=60, 4 bits are reserved),
2. our Base64 variety is `0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz~` (non-standard, because standard [Base64][base64] varieties do not go in the ASCII order thus breaking the ordering),
3. *tailing* zeroes are skipped, e.g. `1230000000` is shortened to `123`.

The tail-skip rule is a bit counter-intuitive, as the normal [Arabic notation][arab] skips *leading* zeroes, e.g. Arabic 0000123 is 123.
This way, the numeric order of `int64_t` matches the alphanumeric order of a Base64x64 string, which is not the case with Arabic numbers.

Swarm uses uniform 64x64 numbers for:

* variable-precision timestamps,
* replica ids and
* predefined constants.

So, Base64x64 is like varint, but for text-based formats and it preserves the ordering. It is mostly used for timestamps and identifiers.


[varint]: https://developers.google.com/protocol-buffers/docs/encoding#varints
[snowflake]: https://dev.twitter.com/overview/api/twitter-ids-json-and-snowflake
[hybrid]: https://www.cse.buffalo.edu/tech-reports/2014-04.pdf
[base64]: https://tools.ietf.org/html/rfc4648#page-5
[arab]: https://en.wikipedia.org/wiki/Arabic_numerals
